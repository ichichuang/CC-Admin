<!--
  @copyright Copyright (c) 2025 chichuang
  @license MIT
  @description cc-admin 企业级后台管理框架 - testing-guide
  本文件为 chichuang 原创，禁止擅自删除署名或用于商业用途。
-->

# 测试指南

## 概述

cc-admin 采用多层次的测试策略，包括单元测试、组件测试和端到端测试，确保代码质量和应用稳定性。

## 🧪 测试策略

### 测试金字塔

```
    🔺 E2E Tests (少量)
   🔺🔺 Integration Tests (适量)
  🔺🔺🔺 Component Tests (较多)
 🔺🔺🔺🔺 Unit Tests (大量)
```

### 测试类型

- **单元测试**: 测试工具函数、Store 模块等独立单元
- **组件测试**: 测试 Vue 组件的行为和交互
- **集成测试**: 测试模块间的协作
- **端到端测试**: 测试完整的用户流程

## 🔬 单元测试

### 测试范围

- 工具函数和工具类
- Store 模块的状态管理
- 组合式函数的逻辑
- API 接口的封装

### 测试工具

- **Vitest**: 现代化的测试框架
- **@vue/test-utils**: Vue 组件测试工具
- **jsdom**: 浏览器环境模拟

## 🧩 组件测试

### 测试重点

- 组件渲染正确性
- 用户交互响应
- Props 和事件处理
- 样式和主题应用

### 测试策略

- 使用 `@vue/test-utils` 进行组件挂载
- 模拟用户交互和事件
- 验证组件状态变化
- 测试组件间的通信

## 🌐 端到端测试

### 测试工具

- **Playwright**: 现代化的 E2E 测试框架
- 支持多浏览器测试
- 自动截图和视频录制
- 强大的选择器和断言

### 测试场景

- 用户登录流程
- 页面导航和路由
- 表单提交和验证
- 数据展示和交互

## 📊 测试覆盖率

### 覆盖率目标

- **全局覆盖率**: 80% 以上
- **分支覆盖率**: 80% 以上
- **函数覆盖率**: 80% 以上
- **行覆盖率**: 80% 以上

### 覆盖率报告

- 生成 HTML 格式报告
- 集成到 CI/CD 流程
- 设置覆盖率阈值检查

## 🚀 测试命令

### 常用命令

```bash
# 运行所有测试
pnpm test

# 运行测试并监听变化
pnpm test:watch

# 运行测试并生成覆盖率
pnpm test:coverage

# 运行 E2E 测试
pnpm test:e2e
```

## 🎯 最佳实践

### 1. 测试命名

- 使用描述性的测试名称
- 遵循 "should" 模式
- 清晰表达测试意图

### 2. 测试组织

- 按功能模块组织测试
- 使用 describe 块分组
- 保持测试文件结构清晰

### 3. 测试数据

- 使用工厂函数创建测试数据
- 避免硬编码测试数据
- 使用测试夹具（fixtures）

### 4. 异步测试

- 正确处理异步操作
- 使用 async/await 语法
- 设置合理的超时时间

## 🔧 故障排除

### 常见问题

1. **测试环境问题** - 检查 jsdom 配置
2. **路径别名问题** - 验证 vitest 配置
3. **组件渲染问题** - 检查测试工具配置

### 调试技巧

- 使用 `console.log` 调试测试逻辑
- 检查测试环境配置
- 验证依赖项安装

通过这套测试体系，cc-admin 确保了代码质量和应用稳定性。
