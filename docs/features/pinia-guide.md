<!--
  @copyright Copyright (c) 2025 chichuang
  @license MIT
  @description CC-Admin 企业级后台管理框架 - pinia-guide
  本文件为 chichuang 原创，禁止擅自删除署名或用于商业用途。
-->

# 状态管理指南

## 概述

CC-Admin 使用 Pinia 作为状态管理方案，采用模块化设计和统一的目录结构，提供类型安全的状态管理体验。

## 🏗️ 架构设计

### 目录结构

```
src/stores/
├── index.ts              # 🚪 统一导出入口
└── modules/              # 📦 具体 Store 模块
    ├── app.ts            # 应用全局状态
    ├── user.ts           # 用户信息管理
    ├── color.ts          # 主题颜色管理
    ├── size.ts           # 尺寸配置管理
    ├── layout.ts         # 布局状态管理
    ├── locale.ts         # 国际化状态
    ├── permission.ts     # 权限管理
    └── postcss.ts        # PostCSS 适配器
```

## 📦 Store 模块开发

### 应用状态管理

- 应用标题和版本信息
- 全局加载状态管理
- 侧边栏折叠状态
- 全屏模式状态
- 持久化配置

### 用户状态管理

- 用户信息和认证状态
- 角色和权限管理
- 登录和登出操作
- 用户信息缓存

### 主题状态管理

- 颜色主题配置
- 尺寸主题配置
- 主题切换功能
- 主题持久化

### 布局状态管理

- 布局模式配置
- 组件显示状态
- 响应式布局状态
- 布局偏好设置

### 国际化状态管理

- 当前语言设置
- 语言切换功能
- 语言包加载状态
- 语言偏好持久化

### 权限状态管理

- 用户权限列表
- 权限验证功能
- 动态权限更新
- 权限缓存管理

## 🔧 开发规范

### Store 命名规范

- 使用 `use` 前缀
- 使用 PascalCase 命名
- 模块名使用 camelCase
- 文件名与 Store 名一致

### 状态设计原则

- 单一职责原则
- 最小化状态设计
- 避免状态冗余
- 合理的数据结构

### 持久化策略

- 选择性持久化
- 敏感数据不持久化
- 合理的存储策略
- 数据清理机制

## 🚀 性能优化

### 状态分割

- 按功能模块分割
- 避免大状态对象
- 合理的数据粒度
- 模块间解耦

### 计算属性优化

- 缓存计算结果
- 避免重复计算
- 合理的依赖关系
- 性能监控

### 订阅优化

- 按需订阅状态
- 避免过度订阅
- 及时取消订阅
- 内存泄漏防护

## 🔄 状态同步

### 组件间通信

- 父子组件通信
- 兄弟组件通信
- 跨层级通信
- 事件总线机制

### 异步状态管理

- 异步操作状态
- 加载状态管理
- 错误状态处理
- 重试机制

### 状态重置

- 页面切换重置
- 用户登出重置
- 手动重置功能
- 自动清理机制

## 🛡️ 类型安全

### TypeScript 支持

- 完整的类型定义
- 状态类型约束
- 方法参数类型
- 返回值类型

### 类型推导

- 自动类型推导
- 泛型支持
- 联合类型
- 条件类型

## 📊 调试工具

### 开发工具

- Pinia DevTools 支持
- 状态快照功能
- 时间旅行调试
- 性能分析

### 日志记录

- 状态变更日志
- 操作追踪
- 错误日志
- 性能日志

## 🔗 最佳实践

### 状态组织

- 按业务功能组织
- 清晰的模块边界
- 统一的命名规范
- 良好的文档注释

### 状态访问

- 统一的状态访问
- 合理的封装
- 避免直接修改
- 类型安全访问

### 状态更新

- 不可变更新
- 批量更新优化
- 事务性更新
- 回滚机制
